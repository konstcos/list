var W=Object.defineProperty;var F=(n,e,a)=>e in n?W(n,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[e]=a;var V=(n,e,a)=>(F(n,typeof e!="symbol"?e+"":e,a),a);import{f as U,_ as b,r as o,o as c,c as u,d as t,w as s,g as A,e as L,b as _,p as D,h as O,a as k,F as T,i as j,t as E}from"./index-mvd_uvtT.js";const I={async getUseLinks(){return(await U.post("links/user-links",{})).data},async saveLink(n){return(await U.post("links/save-link",{link:n})).data}};class R{constructor(e={}){V(this,"id",0);V(this,"link","");this.id=e.id??0,this.link=e.link??""}clear(){this.link=""}}class B{async getUserLinks(){try{return await I.getUseLinks()}catch{return!1}}async saveLink(e){try{return await I.saveLink(e)}catch{return!1}}}class N{constructor(){this.linksRepository=new B}async getUserLinks(){try{const e=await this.linksRepository.getUserLinks();if(e.status==="success"){let a=[];for(let v of e.data.links)a.push(new R({id:v.id,link:v.link}));return a}return[]}catch{return!1}}async saveLink(e){try{return await this.linksRepository.saveLink(e)}catch{return!1}}}const q={name:"LinkEditor",setup(){const n=new B,e=new N;return{linkRepository:n,linkUseCase:e}},props:{modelValue:{type:Boolean,default:!1},linkId:{type:Number,default:0}},data(){return{modalOpen:this.value,link:null,loading:!0}},watch:{modelValue(n){n?this.openModal():this.closeModal()},modalOpen(n){n&&this.loadWalletData()}},methods:{openModal(){this.modalOpen=!0,this.clearLinkData()},closeModal(){this.modalOpen=!1,this.$emit("update:modelValue",!1)},async saveLink(){this.loading=!0,await this.walletRepository.saveWallet(this.wallet),this.loading=!1,this.$emit("reload"),this.closeModal()},clearLinkData(){this.link&&this.link.clear()},async getLinkData(){this.link=null,this.loading=!0,this.loading=!1},loadWalletData(){this.walletId===0?(this.link=new R,this.loading=!1):this.getLinkData()}}},G=n=>(D("data-v-81434633"),n=n(),O(),n),H=G(()=>k("span",{class:"headline"},"Линк",-1)),J={key:0},K={key:1};function P(n,e,a,v,l,d){const w=o("v-card-title"),p=o("v-progress-linear"),r=o("v-textarea"),h=o("v-card-text"),f=o("v-btn"),y=o("v-spacer"),g=o("v-card-actions"),C=o("v-card"),x=o("v-dialog");return c(),u("div",null,[t(x,{modelValue:l.modalOpen,"onUpdate:modelValue":e[1]||(e[1]=m=>l.modalOpen=m),"max-width":"500px","onClick:outside":d.closeModal},{default:s(()=>[t(C,null,{default:s(()=>[t(w,null,{default:s(()=>[H]),_:1}),l.modalOpen?(c(),A(h,{key:0},{default:s(()=>[l.loading?(c(),u("div",J,[t(p,{indeterminate:"",color:"primary"})])):L("",!0),l.link?(c(),u("div",K,[t(r,{modelValue:l.link.link,"onUpdate:modelValue":e[0]||(e[0]=m=>l.link.link=m),label:"Link"},null,8,["modelValue"])])):L("",!0)]),_:1})):L("",!0),t(g,null,{default:s(()=>[t(f,{density:"compact",color:"primary",onClick:d.closeModal},{default:s(()=>[_("Закрыть")]),_:1},8,["onClick"]),t(y),t(f,{density:"compact",color:"primary",onClick:d.saveLink},{default:s(()=>[_("Сохранить")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue","onClick:outside"])])}const Q=b(q,[["render",P],["__scopeId","data-v-81434633"]]),X={name:"Links",components:{LinkEditor:Q},setup(){return{linksUseCase:new N}},data(){return{links:[],loading:!1,newLink:null,linkEditorModal:{show:!1,linkId:0},deleteLinkModal:{show:!1,linkId:0}}},methods:{async saveLink(){if(this.newLink&&this.newLink.trim().length===0)return!1;await this.linksUseCase.saveLink(this.newLink),this.loadLinks()},openLinkEditor(n=0){this.linkEditorModal.linkId=n,this.linkEditorModal.show=!0},async loadLinks(){this.loading=!0,this.links=await this.linksUseCase.getUserLinks(),this.loading=!1},openDeleteLinkModal(n){this.deleteLinkModal.linkId=n.id,this.deleteLinkModal.show=!0}},mounted(){this.loadLinks()}},M=n=>(D("data-v-a2c25fcd"),n=n(),O(),n),Y=M(()=>k("h1",null,"Каталог ссылок",-1)),Z={class:"mt-4"},$={key:0},ee={class:"link-id"},ne=["href"],te=M(()=>k("span",{class:"headline"},"Удаление линка",-1)),le=M(()=>k("div",null," Уверены что хотите удалить линк? ",-1));function se(n,e,a,v,l,d){const w=o("v-text-field"),p=o("v-col"),r=o("v-btn"),h=o("v-row"),f=o("LinkEditor"),y=o("v-card-title"),g=o("v-card-text"),C=o("v-spacer"),x=o("v-card-actions"),m=o("v-card"),S=o("v-dialog");return c(),u("div",null,[Y,k("div",Z,[t(h,null,{default:s(()=>[t(p,null,{default:s(()=>[t(w,{density:"compact",modelValue:l.newLink,"onUpdate:modelValue":e[0]||(e[0]=i=>l.newLink=i)},null,8,["modelValue"])]),_:1}),t(p,null,{default:s(()=>[t(r,{size:"small",onClick:e[1]||(e[1]=i=>d.saveLink()),color:"primary"},{default:s(()=>[_(" Сохранить ")]),_:1}),t(r,{class:"ml-2",size:"small",onClick:e[2]||(e[2]=i=>l.newLink=null)},{default:s(()=>[_(" Очистить ")]),_:1})]),_:1})]),_:1}),l.loading?(c(),u("div",$," Загрузка... ")):L("",!0),k("div",null,[(c(!0),u(T,null,j(l.links,i=>(c(),u("div",{key:i.id},[t(h,null,{default:s(()=>[t(p,null,{default:s(()=>[k("div",ee,E(i.id),1),k("a",{class:"",href:i.link,target:"_blank"},E(i.link),9,ne),t(r,{class:"ml-3",size:"x-small",onClick:z=>d.openLinkEditor(i.id),disabled:l.loading,density:"compact",variant:"text",icon:"mdi:mdi-pencil"},null,8,["onClick","disabled"]),t(r,{class:"ml-3",size:"x-small",onClick:z=>d.openDeleteLinkModal(i),disabled:l.loading,density:"compact",variant:"text",icon:"mdi:mdi-delete"},null,8,["onClick","disabled"])]),_:2},1024)]),_:2},1024)]))),128))])]),t(f,{modelValue:l.linkEditorModal.show,"onUpdate:modelValue":e[3]||(e[3]=i=>l.linkEditorModal.show=i),"link-id":l.linkEditorModal.linkId,onReload:e[4]||(e[4]=i=>d.loadLinks())},null,8,["modelValue","link-id"]),t(S,{modelValue:l.deleteLinkModal.show,"onUpdate:modelValue":e[6]||(e[6]=i=>l.deleteLinkModal.show=i),"max-width":"500px",onClick:e[7]||(e[7]=i=>l.deleteLinkModal.show=!1)},{default:s(()=>[t(m,null,{default:s(()=>[t(y,null,{default:s(()=>[te]),_:1}),t(g,null,{default:s(()=>[le]),_:1}),t(x,null,{default:s(()=>[t(r,{density:"compact",color:"primary",onClick:e[5]||(e[5]=i=>l.deleteLinkModal.show=!1)},{default:s(()=>[_("Закрыть")]),_:1}),t(C),t(r,{density:"compact",color:"error",onClick:d.saveLink},{default:s(()=>[_("Удалить")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const ae=b(X,[["render",se],["__scopeId","data-v-a2c25fcd"]]);export{ae as default};
