var F=Object.defineProperty;var j=(n,e,a)=>e in n?F(n,e,{enumerable:!0,configurable:!0,writable:!0,value:a}):n[e]=a;var E=(n,e,a)=>(j(n,typeof e!="symbol"?e+"":e,a),a);import{f as V,_ as R,r as s,o as c,c as u,d as t,w as i,g as q,e as L,b as _,p as I,h as B,a as k,F as A,i as T,t as O}from"./index-r7KfXBOR.js";const b={async getUseLinks(){return(await V.post("links/user-links",{})).data},async saveLink(n){return(await V.post("links/save-link",{id:n.id,link:n.link})).data},async deleteLink(n){return(await V.post("links/delete-link",{link_id:n.id})).data}};class w{constructor(e={}){E(this,"id",0);E(this,"link","");this.id=e.id??0,this.link=e.link??""}clear(){this.link=""}}class D{async getUserLinks(){try{return await b.getUseLinks()}catch{return!1}}async saveLink(e){try{return await b.saveLink(e)}catch{return!1}}async deleteLink(e){try{return await b.deleteLink(e)}catch{return!1}}}class S{constructor(){this.linksRepository=new D}async getUserLinks(){try{const e=await this.linksRepository.getUserLinks();if(e.status==="success"){let a=[];for(let v of e.data.links)a.push(new w({id:v.id,link:v.link}));return a}return[]}catch{return!1}}async saveLink(e){try{return await this.linksRepository.saveLink(e)}catch{return!1}}async deleteLink(e){try{return await this.linksRepository.deleteLink(e)}catch{return!1}}}const W={name:"LinkEditor",setup(){const n=new D,e=new S;return{linkRepository:n,linkUseCase:e}},props:{modelValue:{type:Boolean,default:!1},link:{type:Object,required:!0}},data(){return{modalOpen:this.value,linkEditor:{id:0,link:""},loading:!1}},watch:{modelValue(n){n?this.openModal():this.closeModal()},modalOpen(n){n&&(this.linkEditor.id=this.link.id,this.linkEditor.link=this.link.link)}},methods:{openModal(){this.modalOpen=!0,this.clearLinkData()},closeModal(){this.modalOpen=!1,this.$emit("update:modelValue",!1)},async saveLink(){this.loading=!0,await this.linkRepository.saveLink(new w({id:this.linkEditor.id,link:this.linkEditor.link})),this.loading=!1,this.$emit("reload"),this.closeModal()},clearLinkData(){this.linkEditor={id:0,link:""}}}},G=n=>(I("data-v-fd25ff54"),n=n(),B(),n),H=G(()=>k("span",{class:"headline"},"Линк",-1)),J={key:0},K={key:1};function P(n,e,a,v,l,d){const y=s("v-card-title"),p=s("v-progress-linear"),r=s("v-textarea"),h=s("v-card-text"),f=s("v-btn"),g=s("v-spacer"),C=s("v-card-actions"),M=s("v-card"),x=s("v-dialog");return c(),u("div",null,[t(x,{modelValue:l.modalOpen,"onUpdate:modelValue":e[1]||(e[1]=m=>l.modalOpen=m),"max-width":"500px","onClick:outside":d.closeModal},{default:i(()=>[t(M,null,{default:i(()=>[t(y,null,{default:i(()=>[H]),_:1}),l.modalOpen?(c(),q(h,{key:0},{default:i(()=>[l.loading?(c(),u("div",J,[t(p,{indeterminate:"",color:"primary"})])):L("",!0),l.linkEditor?(c(),u("div",K,[t(r,{modelValue:l.linkEditor.link,"onUpdate:modelValue":e[0]||(e[0]=m=>l.linkEditor.link=m),label:"Link",rows:"2"},null,8,["modelValue"])])):L("",!0)]),_:1})):L("",!0),t(C,null,{default:i(()=>[t(f,{density:"compact",color:"primary",onClick:d.closeModal},{default:i(()=>[_("Закрыть")]),_:1},8,["onClick"]),t(g),t(f,{density:"compact",color:"primary",onClick:d.saveLink},{default:i(()=>[_("Сохранить")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue","onClick:outside"])])}const Q=R(W,[["render",P],["__scopeId","data-v-fd25ff54"]]),X={name:"Links",components:{LinkEditor:Q},setup(){return{linksUseCase:new S}},data(){return{links:[],loading:!1,newLink:null,linkEditorModal:{show:!1,link:{}},deleteLinkModal:{show:!1,link:null}}},methods:{async saveLink(){if(this.newLink&&this.newLink.trim().length===0)return!1;await this.linksUseCase.saveLink(new w({id:0,link:this.newLink})),this.newLink=null,this.loadLinks()},openLinkEditor(n=null){this.linkEditorModal.link=n||new w,this.linkEditorModal.show=!0},async loadLinks(){this.loading=!0,this.links=await this.linksUseCase.getUserLinks(),this.loading=!1},openDeleteLinkModal(n){this.deleteLinkModal.link=n,this.deleteLinkModal.show=!0},async deleteLink(){if(this.deleteLinkModal&&!this.deleteLinkModal.link)return!1;await this.linksUseCase.deleteLink(this.deleteLinkModal.link),this.loadLinks()}},mounted(){this.loadLinks()}},U=n=>(I("data-v-b5ab4b78"),n=n(),B(),n),Y=U(()=>k("h1",null,"Каталог ссылок",-1)),Z={class:"mt-4"},$={key:0},ee={class:"link-id"},ne=["href"],te=U(()=>k("span",{class:"headline"},"Удаление линка",-1)),le=U(()=>k("div",null," Уверены что хотите удалить линк? ",-1));function ie(n,e,a,v,l,d){const y=s("v-text-field"),p=s("v-col"),r=s("v-btn"),h=s("v-row"),f=s("LinkEditor"),g=s("v-card-title"),C=s("v-card-text"),M=s("v-spacer"),x=s("v-card-actions"),m=s("v-card"),z=s("v-dialog");return c(),u("div",null,[Y,k("div",Z,[t(h,null,{default:i(()=>[t(p,null,{default:i(()=>[t(y,{density:"compact",modelValue:l.newLink,"onUpdate:modelValue":e[0]||(e[0]=o=>l.newLink=o)},null,8,["modelValue"])]),_:1}),t(p,null,{default:i(()=>[t(r,{size:"small",onClick:e[1]||(e[1]=o=>d.saveLink()),color:"primary"},{default:i(()=>[_(" Сохранить ")]),_:1}),t(r,{class:"ml-2",size:"small",onClick:e[2]||(e[2]=o=>l.newLink=null)},{default:i(()=>[_(" Очистить ")]),_:1})]),_:1})]),_:1}),l.loading?(c(),u("div",$," Загрузка... ")):L("",!0),k("div",null,[(c(!0),u(A,null,T(l.links,o=>(c(),u("div",{key:o.id},[t(h,null,{default:i(()=>[t(p,null,{default:i(()=>[k("div",ee,O(o.id),1),k("a",{class:"",href:o.link,target:"_blank"},O(o.link),9,ne),t(r,{class:"ml-3",size:"x-small",onClick:N=>d.openLinkEditor(o),disabled:l.loading,density:"compact",variant:"text",icon:"mdi:mdi-pencil"},null,8,["onClick","disabled"]),t(r,{class:"ml-3",size:"x-small",onClick:N=>d.openDeleteLinkModal(o),disabled:l.loading,density:"compact",variant:"text",icon:"mdi:mdi-delete"},null,8,["onClick","disabled"])]),_:2},1024)]),_:2},1024)]))),128))])]),t(f,{modelValue:l.linkEditorModal.show,"onUpdate:modelValue":e[3]||(e[3]=o=>l.linkEditorModal.show=o),link:l.linkEditorModal.link,onReload:e[4]||(e[4]=o=>d.loadLinks())},null,8,["modelValue","link"]),t(z,{modelValue:l.deleteLinkModal.show,"onUpdate:modelValue":e[6]||(e[6]=o=>l.deleteLinkModal.show=o),"max-width":"500px",onClick:e[7]||(e[7]=o=>l.deleteLinkModal.show=!1)},{default:i(()=>[t(m,null,{default:i(()=>[t(g,null,{default:i(()=>[te]),_:1}),t(C,null,{default:i(()=>[le]),_:1}),t(x,null,{default:i(()=>[t(r,{density:"compact",color:"primary",onClick:e[5]||(e[5]=o=>l.deleteLinkModal.show=!1)},{default:i(()=>[_("Закрыть")]),_:1}),t(M),t(r,{density:"compact",color:"error",onClick:d.deleteLink},{default:i(()=>[_("Удалить")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])])}const ae=R(X,[["render",ie],["__scopeId","data-v-b5ab4b78"]]);export{ae as default};
