import{_ as w,u as v,r as a,o as m,c as u,a as c,b as n,d as o,w as t,L as V,t as y,e as k}from"./index-smbjfMYx.js";const C={name:"LoginView",setup(){const{setToken:r,clearUser:i,user:p}=v(),f=new V;return{setToken:r,clearUser:i,user:p,loginRepository:f}},data(){return{section:"login",sections:{login:"login",registration:"registration"},error:!1,loading:!1,login:{email:"",password:""},registration:{name:"",email:"",password:"",passwordConfirmation:""}}},methods:{async loginUser(){this.clearError(),this.loading=!0,await this.loginRepository.login(this.login.email,this.login.password)&&this.$router.push({name:"home"}),this.loading=!1},async registerUser(){if(this.clearError(),!this.checkRegistrationData())return;this.loading=!0,(await this.loginRepository.register(this.registration.name,this.registration.email,this.registration.password)).status==="success"&&this.$router.push({name:"home"}),this.loading=!1},changeSection(r){this.clearError(),this.clearLoginData(),this.clearRegistrationData(),this.section=r},checkRegistrationData(){return this.registration.email===""?(this.error="Введите email",!1):this.registration.password===""?(this.error="Введите пароль",!1):this.registration.passwordConfirmation===""?(this.error="Введите подтверждение пароля",!1):this.registration.password!==this.registration.passwordConfirmation?(this.error="Пароли не совпадают",!1):!0},clearError(){this.error=!1},clearRegistrationData(){this.registration.name="",this.registration.email="",this.registration.password="",this.registration.passwordConfirmation=""},clearLoginData(){this.login.email="",this.login.password=""}},mounted(){}},U={class:"main_login_block"},x={key:0},R={class:"login_title"},D={key:1},E={class:"login_title"},q={key:0,class:"mb-4 error_block"};function L(r,i,p,f,e,d){const g=a("v-btn"),l=a("v-text-field"),_=a("v-form"),h=a("v-card-text"),b=a("v-card");return m(),u("div",U,[e.section===e.sections.login?(m(),u("div",x,[c("div",R,[n(" Вход "),o(g,{size:"small",onClick:i[0]||(i[0]=s=>d.changeSection(e.sections.registration)),disabled:e.loading},{default:t(()=>[n(" Зарегистрироваться ")]),_:1},8,["disabled"])]),c("div",null,[o(b,{color:"indigo",variant:"outlined"},{default:t(()=>[o(h,{class:"pt-6"},{default:t(()=>[o(_,null,{default:t(()=>[o(l,{modelValue:e.login.email,"onUpdate:modelValue":i[1]||(i[1]=s=>e.login.email=s),label:"Email",density:"compact",required:"",disabled:e.loading},null,8,["modelValue","disabled"]),o(l,{modelValue:e.login.password,"onUpdate:modelValue":i[2]||(i[2]=s=>e.login.password=s),label:"Пароль",type:"password",density:"compact",required:"",disabled:e.loading},null,8,["modelValue","disabled"]),o(g,{color:"primary",size:"small",onClick:d.loginUser,loading:e.loading},{default:t(()=>[n("Войти ")]),_:1},8,["onClick","loading"])]),_:1})]),_:1})]),_:1})])])):(m(),u("div",D,[c("div",E,[n(" Регистрация "),o(g,{size:"small",onClick:i[3]||(i[3]=s=>d.changeSection(e.sections.login)),disabled:e.loading},{default:t(()=>[n(" Войти ")]),_:1},8,["disabled"])]),c("div",null,[o(b,{color:"indigo",variant:"outlined"},{default:t(()=>[o(h,{class:"pt-6"},{default:t(()=>[o(_,null,{default:t(()=>[o(l,{modelValue:e.registration.name,"onUpdate:modelValue":i[4]||(i[4]=s=>e.registration.name=s),label:"Name",density:"compact",type:"text",required:"",disabled:e.loading},null,8,["modelValue","disabled"]),o(l,{modelValue:e.registration.email,"onUpdate:modelValue":i[5]||(i[5]=s=>e.registration.email=s),label:"Email",type:"email",density:"compact",required:"",disabled:e.loading},null,8,["modelValue","disabled"]),o(l,{modelValue:e.registration.password,"onUpdate:modelValue":i[6]||(i[6]=s=>e.registration.password=s),label:"Пароль",density:"compact",type:"password",required:"",disabled:e.loading},null,8,["modelValue","disabled"]),o(l,{modelValue:e.registration.passwordConfirmation,"onUpdate:modelValue":i[7]||(i[7]=s=>e.registration.passwordConfirmation=s),label:"Подтверждение пароля",density:"compact",type:"password",required:"",disabled:e.loading},null,8,["modelValue","disabled"]),e.error?(m(),u("div",q,y(e.error),1)):k("",!0),o(g,{color:"primary",size:"small",onClick:d.registerUser,loading:e.loading},{default:t(()=>[n("Зарегистрироваться ")]),_:1},8,["onClick","loading"])]),_:1})]),_:1})]),_:1})])]))])}const z=w(C,[["render",L],["__scopeId","data-v-40dbf112"]]);export{z as default};
