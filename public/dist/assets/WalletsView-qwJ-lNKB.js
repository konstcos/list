var M=Object.defineProperty;var I=(t,e,n)=>e in t?M(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var _=(t,e,n)=>(I(t,typeof e!="symbol"?e+"":e,n),n);import{f as x,_ as g,r as o,o as c,c as d,d as l,w as s,g as U,e as V,b as k,p as D,h as O,a as f}from"./index-3HjJZ7Fr.js";class N{constructor(e={}){_(this,"id",0);_(this,"name","");_(this,"description","");_(this,"сurrency","");_(this,"balance",0);this.id=e.id??0,this.name=e.name??"",this.description=e.description??"",this.balance=e.balance??0}clear(){this.name="",this.description="",this.balance=0}}const b={async getUserWallets(){return(await x.post("wallet/user-wallets",{})).data},async saveWallet(t){return(await x.post("wallet/save",t)).data}};class E{async getUserWallets(){try{const e=await b.getUserWallets();if(e.status==="success")return e}catch{return!1}}async saveWallet(e){try{const n=await b.saveWallet({id:e.id,name:e.name,description:e.description,balance:e.balance});if(n.status==="success")return n}catch{return!1}}}const B={name:"WalletEditor",setup(){return{walletRepository:new E}},props:{modelValue:{type:Boolean,default:!1},walletId:{type:Number,default:0}},data(){return{modalOpen:this.value,wallet:null}},watch:{modelValue(t){t?this.openModal():this.closeModal()},modalOpen(t){t&&(console.log("mounted"),this.loadWalletData())}},methods:{openModal(){this.modalOpen=!0,this.clearWalletData()},closeModal(){this.modalOpen=!1,this.$emit("update:modelValue",!1)},async saveWallet(){console.log("saveWallet",this.wallet);const t=await this.walletRepository.saveWallet(this.wallet);console.log("result",t)},clearWalletData(){this.wallet&&this.wallet.clear()},loadWalletData(){this.walletId===0?(console.log("loadWalletData new wallet",this.walletId),this.wallet=new N):console.log("loadWalletData",this.walletId)}}},L=t=>(D("data-v-4e906d41"),t=t(),O(),t),S=L(()=>f("span",{class:"headline"},"Создание нового кошелька",-1)),T={key:0},A={key:1};function $(t,e,n,C,a,i){const r=o("v-card-title"),u=o("v-text-field"),p=o("v-textarea"),h=o("v-card-text"),w=o("v-btn"),v=o("v-spacer"),W=o("v-card-actions"),y=o("v-card"),R=o("v-dialog");return c(),d("div",null,[l(R,{modelValue:a.modalOpen,"onUpdate:modelValue":e[2]||(e[2]=m=>a.modalOpen=m),"max-width":"500px","onClick:outside":i.closeModal},{default:s(()=>[l(y,null,{default:s(()=>[l(r,null,{default:s(()=>[S]),_:1}),a.modalOpen?(c(),U(h,{key:0},{default:s(()=>[a.wallet?(c(),d("div",T,[l(u,{modelValue:a.wallet.name,"onUpdate:modelValue":e[0]||(e[0]=m=>a.wallet.name=m),label:"Name"},null,8,["modelValue"]),l(p,{modelValue:a.wallet.description,"onUpdate:modelValue":e[1]||(e[1]=m=>a.wallet.description=m),label:"Description"},null,8,["modelValue"])])):(c(),d("div",A," загрузка... "))]),_:1})):V("",!0),l(W,null,{default:s(()=>[l(w,{density:"compact",color:"primary",onClick:i.closeModal},{default:s(()=>[k("Закрыть")]),_:1},8,["onClick"]),l(v),l(w,{density:"compact",color:"primary",onClick:i.saveWallet},{default:s(()=>[k("Сохранить")]),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue","onClick:outside"])])}const j=g(B,[["render",$],["__scopeId","data-v-4e906d41"]]),q={name:"WalletsList",setup(){return{walletRepository:new E}},components:{WalletEditor:j},data(){return{wallets:[],loading:!1,walletEditorModal:!1}},methods:{async loadWallets(){this.loading=!0;const t=await this.walletRepository.getUserWallets();console.log("result",t),this.loading=!1},openWalletEditor(){this.walletEditorModal=!0}},mounted(){this.loadWallets()}},z={key:0},F={key:1,class:"text-center"};function G(t,e,n,C,a,i){const r=o("v-btn"),u=o("VCol"),p=o("VRow"),h=o("v-progress-linear"),w=o("VCardText"),v=o("VCard"),W=o("WalletEditor");return c(),d("div",null,[f("div",null,[l(v,null,{default:s(()=>[l(w,null,{default:s(()=>[l(p,{class:"mb-3"},{default:s(()=>[l(u,null,{default:s(()=>[l(r,{loading:a.loading,onClick:i.loadWallets,color:"primary",density:"compact",icon:"mdi:mdi-reload"},null,8,["loading","onClick"])]),_:1}),l(u,{class:"text-end"},{default:s(()=>[l(r,{onClick:i.openWalletEditor,disabled:a.loading,density:"compact",icon:"mdi:mdi-plus"},null,8,["onClick","disabled"])]),_:1})]),_:1}),a.loading?(c(),d("div",z,[l(h,{indeterminate:"",color:"primary"})])):V("",!0),!a.loading&&a.wallets.length===0?(c(),d("div",F," у вас пока нет кошельков ")):V("",!0)]),_:1})]),_:1})]),l(W,{modelValue:a.walletEditorModal,"onUpdate:modelValue":e[0]||(e[0]=y=>a.walletEditorModal=y)},null,8,["modelValue"])])}const H=g(q,[["render",G]]),J={name:"Wallets",components:{WalletsList:H}},K=f("h1",null,"Мои кошельки",-1),P={class:"mt-4"};function Q(t,e,n,C,a,i){const r=o("WalletsList"),u=o("VCol"),p=o("VRow");return c(),d("div",null,[K,f("div",P,[l(p,null,{default:s(()=>[l(u,{cols:"4"},{default:s(()=>[l(r)]),_:1})]),_:1})])])}const Z=g(J,[["render",Q]]);export{Z as default};
